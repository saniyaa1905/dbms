-- DROP TABLES IF THEY EXIST
DROP TABLE IF EXISTS employee_master;
DROP TABLE IF EXISTS branch_master;

-- 1. Create branch_master table
CREATE TABLE branch_master (
    branch_id INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL
);

-- 2. Create employee_master table
CREATE TABLE employee_master (
    emp_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    middle_name VARCHAR(50),
    last_name VARCHAR(50),
    department VARCHAR(50),
    manager_id INT
);

-- 3. Insert records into branch_master
INSERT INTO branch_master (branch_id, branch_name) VALUES
(1, 'Pune'),
(2, 'Mumbai'),
(3, 'Delhi');

-- Check branch_master data
SELECT * FROM branch_master;

-- 4. Insert records into employee_master
INSERT INTO employee_master (emp_id, first_name, middle_name, last_name, department, manager_id) VALUES
(101, 'Amrita', 'R', 'Sharma', 'IT', 201),
(102, 'Rahul', 'K', 'Deshmukh', 'HR', 202),
(103, 'Sneha', 'M', 'Patil', 'Finance', 201),
(104, 'Amit', 'S', 'Kumar', 'IT', 201);

-- Check employee_master data
SELECT * FROM employee_master;

-- 5. Create index on first_name
CREATE INDEX idx_emp_name ON employee_master (first_name);

-- Test index effect
SELECT * FROM employee_master WHERE first_name = 'Rahul';

-- 6. Create a view for employee details
CREATE OR REPLACE VIEW employee_view AS
SELECT emp_id,
       CONCAT(first_name, ' ', middle_name, ' ', last_name) AS emp_name,
       department,
       manager_id
FROM employee_master;

-- Test the view
SELECT * FROM employee_view;
